(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,a){e.exports=a(49)},48:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(22),i=a(9),o=a(33),c=JSON.parse(localStorage.getItem("users"))||[];var l=a(3),u=Object(l.a)(),A=a(16),m=a(30),E=a(31),h={SUCCESS:"ALERT_SUCCESS",ERROR:"ALERT_ERROR",CLEAR:"ALERT_CLEAR"},d={REGISTER_REQUEST:"USERS_REGISTER_REQUEST",REGISTER_SUCCESS:"USERS_REGISTER_SUCCESS",REGISTER_FAILURE:"USERS_REGISTER_FAILURE",LOGIN_REQUEST:"USERS_LOGIN_REQUEST",LOGIN_SUCCESS:"USERS_LOGIN_SUCCESS",LOGIN_FAILURE:"USERS_LOGIN_FAILURE",LOGOUT:"USERS_LOGOUT",GETALL_REQUEST:"USERS_GETALL_REQUEST",GETALL_SUCCESS:"USERS_GETALL_SUCCESS",GETALL_FAILURE:"USERS_GETALL_FAILURE",DELETE_REQUEST:"USERS_DELETE_REQUEST",DELETE_SUCCESS:"USERS_DELETE_SUCCESS",DELETE_FAILURE:"USERS_DELETE_FAILURE"},g=JSON.parse(localStorage.getItem("user")),f=g?{loggedIn:!0,user:g}:{};var p=a(24),S=a(13);var b=Object(A.c)({authentication:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.LOGIN_REQUEST:return{loggingIn:!0,user:t.user};case d.LOGIN_SUCCESS:return{loggedIn:!0,user:t.user};case d.LOGIN_FAILURE:case d.LOGOUT:return{};default:return e}},registration:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch((arguments.length>1?arguments[1]:void 0).type){case d.REGISTER_REQUEST:return{registering:!0};case d.REGISTER_SUCCESS:case d.REGISTER_FAILURE:return{};default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.GETALL_REQUEST:return{loading:!0};case d.GETALL_SUCCESS:return{items:t.users};case d.GETALL_FAILURE:return{error:t.error};case d.DELETE_REQUEST:return Object(S.a)({},e,{items:e.items.map(function(e){return e.id===t.id?Object(S.a)({},e,{deleting:!0}):e})});case d.DELETE_SUCCESS:return{items:e.items.filter(function(e){return e.id!==t.id})};case d.DELETE_FAILURE:return Object(S.a)({},e,{items:e.items.map(function(e){if(e.id===t.id){e.deleting;var a=Object(p.a)(e,["deleting"]);return Object(S.a)({},a,{deleteError:t.error})}return e})});default:return e}},alert:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.SUCCESS:return{type:"alert-success",message:t.message};case h.ERROR:return{type:"alert-danger",message:t.message};case h.CLEAR:return{};default:return e}}}),C=Object(E.createLogger)(),v=Object(A.d)(b,Object(A.a)(m.a,C));function O(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?{Authorization:"Bearer "+e.token}:{}}var R=a(6),w=a(7),I=a(10),U=a(8),L=a(11),N=a(17),T={success:function(e){return{type:h.SUCCESS,message:e}},error:function(e){return{type:h.ERROR,message:e}},clear:function(){return{type:h.CLEAR}}};var j={login:function(e,t){var a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})};return fetch("/users/authenticate",a).then(G).then(function(e){return localStorage.setItem("user",JSON.stringify(e)),e})},logout:y,register:function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch("/users/register",t).then(G)},getAll:function(){var e={method:"GET",headers:O()};return fetch("/users",e).then(G)},getById:function(e){var t={method:"GET",headers:O()};return fetch("/users/".concat(e),t).then(G)},update:function(e){var t={method:"PUT",headers:Object(S.a)({},O(),{"Content-Type":"application/json"}),body:JSON.stringify(e)};return fetch("/users/".concat(e.id),t).then(G)},delete:function(e){var t={method:"DELETE",headers:O()};return fetch("/users/".concat(e),t).then(G)}};function y(){localStorage.removeItem("user")}function G(e){return e.text().then(function(t){var a=t&&JSON.parse(t);if(!e.ok){401===e.status&&(y(),window.location.reload(!0));var n=a&&a.message||e.statusText;return Promise.reject(n)}return a})}var Q={login:function(e,t){return function(a){var n;a((n={username:e},{type:d.LOGIN_REQUEST,user:n})),j.login(e,t).then(function(e){a(function(e){return{type:d.LOGIN_SUCCESS,user:e}}(e)),u.push("/")},function(e){a(function(e){return{type:d.LOGIN_FAILURE,error:e}}(e)),a(T.error(e))})}},logout:function(){return j.logout(),{type:d.LOGOUT}},register:function(e){return function(t){t(function(e){return{type:d.REGISTER_REQUEST,user:e}}(e)),j.register(e).then(function(e){t(function(e){return{type:d.REGISTER_SUCCESS,user:e}}()),u.push("/login"),t(T.success("Registration successful"))},function(e){t(function(e){return{type:d.REGISTER_FAILURE,error:e}}(e)),t(T.error(e))})}},getAll:function(){return function(e){e({type:d.GETALL_REQUEST}),j.getAll().then(function(t){return e(function(e){return{type:d.GETALL_SUCCESS,users:e}}(t))},function(t){return e(function(e){return{type:d.GETALL_FAILURE,error:e}}(t))})}},delete:function(e){return function(t){t(function(e){return{type:d.DELETE_REQUEST,id:e}}(e)),j.delete(e).then(function(a){t(function(e){return{type:d.DELETE_SUCCESS,id:e}}(e))},function(a){t(function(e,t){return{type:d.DELETE_FAILURE,id:e,error:t}}(e,a))})}}};var k=function(e){var t=e.component,a=Object(p.a)(e,["component"]);return r.a.createElement(N.b,Object.assign({},a,{render:function(e){return localStorage.getItem("user")?r.a.createElement(t,e):r.a.createElement(N.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},_=a(14),D=a(1),P=(a(48),function(e){function t(){var e;return Object(R.a)(this,t),(e=Object(I.a)(this,Object(U.a)(t).call(this))).state={title:[""],content:[""],inputTitle:"",inputContent:"",nowPage:""},e.handleChange=e.handleChange.bind(Object(D.a)(Object(D.a)(e))),e.showCreatePage=e.showCreatePage.bind(Object(D.a)(Object(D.a)(e))),e.handleSubmit=e.handleSubmit.bind(Object(D.a)(Object(D.a)(e))),e.showThisPage=e.showThisPage.bind(Object(D.a)(Object(D.a)(e))),e}return Object(L.a)(t,e),Object(w.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.title.concat(this.state.inputTitle),a=this.state.content.concat(this.state.inputContent);this.setState({title:t,content:a})}},{key:"handleChange",value:function(e){e.preventDefault();var t=e.target,a=t.name,n=t.value;"title"==a?this.setState({inputTitle:n}):this.setState({inputContent:n})}},{key:"showCreatePage",value:function(e){e.preventDefault(),this.setState({nowPage:"createPage"})}},{key:"showThisPage",value:function(e){e.preventDefault(),this.setState({nowPage:e.target.getAttribute("custom-attribute")})}},{key:"render",value:function(){var e=this,t=this.state,a=t.title,n=t.content,s=t.inputTitle,i=t.inputContent,o=t.nowPage;return r.a.createElement("div",null,r.a.createElement("div",{className:"container mainPage"},r.a.createElement("div",{className:"leftMenu col-3 col-lg-3 col-sm-3 "},r.a.createElement("ul",null,a.map(function(t,a){return r.a.createElement("li",{key:a,"custom-attribute":a,onClick:e.showThisPage},t)})),r.a.createElement("a",{onClick:this.showCreatePage},"Create New")),r.a.createElement("div",{className:"createPage col-6 col-lg-6 col-sm-6 "+("createPage"==o?" selected":" notSelected")},r.a.createElement("div",{className:"createInput"},r.a.createElement("h2",null,"create a new page"),r.a.createElement("form",{name:"createPageForm",onSubmit:this.handleSubmit},"title:",r.a.createElement("br",null),r.a.createElement("input",{onChange:this.handleChange,value:s,name:"title",type:"text",required:!0}),r.a.createElement("br",null),"content:",r.a.createElement("br",null),r.a.createElement("input",{onChange:this.handleChange,name:"content",value:i,type:"textarea"}),r.a.createElement("br",null),r.a.createElement("button",null,"submit")))),r.a.createElement("div",{className:" contentPage col-6 col-lg-6 col-sm-6 "+("createPage"==o?" notSelected":" selected")},r.a.createElement("h1",null,a[o]),r.a.createElement("br",null),r.a.createElement("p",null,n[o]))),r.a.createElement("hr",null))}}]),t}(r.a.Component)),M=function(e){function t(){return Object(R.a)(this,t),Object(I.a)(this,Object(U.a)(t).apply(this,arguments))}return Object(L.a)(t,e),Object(w.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Q.getAll())}},{key:"handleDeleteUser",value:function(e){var t=this;return function(a){return t.props.dispatch(Q.delete(e))}}},{key:"render",value:function(){var e=this.props;e.user,e.users;return r.a.createElement("div",{className:"col-md-12 col-md-offset-3"},r.a.createElement(P,null),r.a.createElement("p",null,r.a.createElement(_.a,{to:"/login"},"Logout")))}}]),t}(r.a.Component);var J=Object(i.b)(function(e){var t=e.users;return{user:e.authentication.user,users:t}})(M),F=a(18),B=function(e){function t(e){var a;return Object(R.a)(this,t),(a=Object(I.a)(this,Object(U.a)(t).call(this,e))).props.dispatch(Q.logout()),a.state={username:"",password:"",submitted:!1},a.handleChange=a.handleChange.bind(Object(D.a)(Object(D.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(D.a)(Object(D.a)(a))),a}return Object(L.a)(t,e),Object(w.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(F.a)({},a,n))}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({submitted:!0});var t=this.state,a=t.username,n=t.password,r=this.props.dispatch;a&&n&&r(Q.login(a,n))}},{key:"render",value:function(){var e=this.props.loggingIn,t=this.state,a=t.username,n=t.password,s=t.submitted;return r.a.createElement("div",{className:"col-md-6 col-md-offset-3"},r.a.createElement("h2",null,"Login"),r.a.createElement("form",{name:"form",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"+(s&&!a?" has-error":"")},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",{type:"text",className:"form-control",name:"username",value:a,onChange:this.handleChange}),s&&!a&&r.a.createElement("div",{className:"help-block"},"Username is required")),r.a.createElement("div",{className:"form-group"+(s&&!n?" has-error":"")},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",name:"password",value:n,onChange:this.handleChange}),s&&!n&&r.a.createElement("div",{className:"help-block"},"Password is required")),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary"},"Login"),e&&r.a.createElement("img",{src:"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="}),r.a.createElement(_.a,{to:"/register",className:"btn btn-link"},"Register"))))}}]),t}(r.a.Component);var K=Object(i.b)(function(e){return{loggingIn:e.authentication.loggingIn}})(B),Y=function(e){function t(e){var a;return Object(R.a)(this,t),(a=Object(I.a)(this,Object(U.a)(t).call(this,e))).state={user:{firstName:"",lastName:"",username:"",password:""},submitted:!1},a.handleChange=a.handleChange.bind(Object(D.a)(Object(D.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(D.a)(Object(D.a)(a))),a}return Object(L.a)(t,e),Object(w.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value,r=this.state.user;this.setState({user:Object(S.a)({},r,Object(F.a)({},a,n))})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({submitted:!0});var t=this.state.user,a=this.props.dispatch;t.firstName&&t.lastName&&t.username&&t.password&&a(Q.register(t))}},{key:"render",value:function(){var e=this.props.registering,t=this.state,a=t.user,n=t.submitted;return r.a.createElement("div",{className:"col-md-6 col-md-offset-3"},r.a.createElement("h2",null,"Register"),r.a.createElement("form",{name:"form",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"+(n&&!a.firstName?" has-error":"")},r.a.createElement("label",{htmlFor:"firstName"},"First Name"),r.a.createElement("input",{type:"text",className:"form-control",name:"firstName",value:a.firstName,onChange:this.handleChange}),n&&!a.firstName&&r.a.createElement("div",{className:"help-block"},"First Name is required")),r.a.createElement("div",{className:"form-group"+(n&&!a.lastName?" has-error":"")},r.a.createElement("label",{htmlFor:"lastName"},"Last Name"),r.a.createElement("input",{type:"text",className:"form-control",name:"lastName",value:a.lastName,onChange:this.handleChange}),n&&!a.lastName&&r.a.createElement("div",{className:"help-block"},"Last Name is required")),r.a.createElement("div",{className:"form-group"+(n&&!a.username?" has-error":"")},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",{type:"text",className:"form-control",name:"username",value:a.username,onChange:this.handleChange}),n&&!a.username&&r.a.createElement("div",{className:"help-block"},"Username is required")),r.a.createElement("div",{className:"form-group"+(n&&!a.password?" has-error":"")},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",name:"password",value:a.password,onChange:this.handleChange}),n&&!a.password&&r.a.createElement("div",{className:"help-block"},"Password is required")),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{className:"btn btn-primary"},"Register"),e&&r.a.createElement("img",{src:"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA=="}),r.a.createElement(_.a,{to:"/login",className:"btn btn-link"},"Cancel"))))}}]),t}(r.a.Component);var x=Object(i.b)(function(e){return{registering:e.registration.registering}})(Y),H=function(e){function t(e){var a;Object(R.a)(this,t);var n=(a=Object(I.a)(this,Object(U.a)(t).call(this,e))).props.dispatch;return u.listen(function(e,t){n(T.clear())}),a}return Object(L.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this.props.alert;return r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"col-sm-12 col-sm-offset-0"},e.message&&r.a.createElement("div",{className:"alert ".concat(e.type)},e.message),r.a.createElement(N.c,{history:u},r.a.createElement("div",null,r.a.createElement(k,{exact:!0,path:"/",component:J}),r.a.createElement(N.b,{path:"/login",component:K}),r.a.createElement(N.b,{path:"/register",component:x}))))))}}]),t}(r.a.Component);var W=Object(i.b)(function(e){return{alert:e.alert}})(H);!function(){var e=window.fetch;window.fetch=function(t,a){return new Promise(function(n,r){setTimeout(function(){if(t.endsWith("/users/authenticate")&&"POST"===a.method){var s=JSON.parse(a.body),i=c.filter(function(e){return e.username===s.username&&e.password===s.password});if(i.length){var l=i[0],u={id:l.id,username:l.username,firstName:l.firstName,lastName:l.lastName,token:"fake-jwt-token"};n({ok:!0,text:function(){return Promise.resolve(JSON.stringify(u))}})}else r("Username or password is incorrect")}else if(t.endsWith("/users")&&"GET"===a.method)a.headers&&"Bearer fake-jwt-token"===a.headers.Authorization?n({ok:!0,text:function(){return Promise.resolve(JSON.stringify(c))}}):r("Unauthorised");else if(t.match(/\/users\/\d+$/)&&"GET"===a.method)if(a.headers&&"Bearer fake-jwt-token"===a.headers.Authorization){var A=t.split("/"),m=parseInt(A[A.length-1]),E=c.filter(function(e){return e.id===m}),h=E.length?E[0]:null;n({ok:!0,text:function(){return JSON.stringify(h)}})}else r("Unauthorised");else{if(t.endsWith("/users/register")&&"POST"===a.method){var d=JSON.parse(a.body);return c.filter(function(e){return e.username===d.username}).length?void r('Username "'+d.username+'" is already taken'):(d.id=c.length?Math.max.apply(Math,Object(o.a)(c.map(function(e){return e.id})))+1:1,c.push(d),localStorage.setItem("users",JSON.stringify(c)),void n({ok:!0,text:function(){return Promise.resolve()}}))}if(t.match(/\/users\/\d+$/)&&"DELETE"===a.method)if(a.headers&&"Bearer fake-jwt-token"===a.headers.Authorization){for(var g=t.split("/"),f=parseInt(g[g.length-1]),p=0;p<c.length;p++)if(c[p].id===f){c.splice(p,1),localStorage.setItem("users",JSON.stringify(c));break}n({ok:!0,text:function(){return Promise.resolve()}})}else r("Unauthorised");else e(t,a).then(function(e){return n(e)})}},500)})}}(),Object(s.render)(r.a.createElement(i.a,{store:v},r.a.createElement(W,null)),document.getElementById("app"))}},[[34,1,2]]]);
//# sourceMappingURL=main.bb0ad3fe.chunk.js.map